<div class="card h-100 shadow-sm rounded-4 ai-chat-conversation" data-controller="ai-conversation" data-action="click->ai-conversation#open" data-ai-conversation-chat-id-value="<%= @chat.id %>">
  <%= turbo_stream_from @chat %>
  <div class="card-header d-flex align-items-center justify-content-between">
    <h5 class="mt-3 mb-1 fw-bold fs-5 text-primary"><%= @chat.title.presence || "Nuevo Chat" %></h5>
  </div>

  <div class="card-body"
       data-controller="scroll-bottom"
       data-scroll-bottom-target="container">
    <div id="<%= dom_id(@chat, :messages) %>">
      <%= render @chat.messages %>
    </div>
  </div>

  <div class="card-footer">
    <%= simple_form_for [@chat, @message],
        html: { data: { controller: "chat-submit", chat_submit_target: "form" } } do |f| %>
      <div class="chat-composer">
        <div class="chat-input-wrapper">
          <%= f.text_area :content,
              label: false,
              placeholder: "EscribÃ­ tu mensaje...",
              rows: 2,
              class: "form-control chat-input",
              data: { chat_submit_target: "input", action: "keydown->chat-submit#submitOnEnter" } %>
          <button type="submit" class="chat-send-btn" aria-label="Enviar">
            <i class="fa-solid fa-arrow-up"></i>
          </button>
        </div>
      </div>
    <% end %>
  </div>

</div>
